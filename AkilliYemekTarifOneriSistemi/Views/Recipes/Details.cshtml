@model AkilliYemekTarifOneriSistemi.Models.Recipe

@{
    ViewData["Title"] = Model.Title;
}

<h1 class="mb-3">@Model.Title</h1>

@if (!string.IsNullOrEmpty(Model.ImageUrl))
{
    <img src="@Model.ImageUrl"
         class="img-fluid rounded mb-4"
         style="max-height:400px;object-fit:cover;" />
}

<div class="mb-4">
    <span class="badge bg-dark me-2">
        â±ï¸ @Model.CookingTime dk
    </span>
</div>

<p class="lead">
    @Model.Description
</p>

<hr />

<!-- ğŸ§‚ MALZEMELER -->
<h3 class="mb-3">ğŸ§‚ Malzemeler</h3>

<table class="table table-bordered">
    <thead class="table-light">
        <tr>
            <th>Malzeme</th>
            <th>Miktar</th>
            <th>Gram</th>
            <th>Kalori</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.RecipeIngredients)
        {
            <tr>
                <td>@item.Ingredient.Name</td>
                <td>@item.Quantity @item.Unit</td>
                <td>@Math.Round(item.CalculatedGrams, 1) g</td>
                <td>
                    @{
                        // ğŸ”¥ Kalori hesaplama
                        var calories =
                        item.CalculatedGrams > 0
                        ? (Model.NutritionFacts?.Calories ?? 0)
                        * (item.CalculatedGrams /
                        Model.RecipeIngredients.Sum(x => x.CalculatedGrams))
                        : 0;
                    }

                    @Math.Round(calories, 1) kcal
                </td>
            </tr>
        }
    </tbody>
</table>

<!-- ğŸ“Š TOPLAM BESÄ°N DEÄERLERÄ° -->
@if (Model.NutritionFacts != null)
{
    <hr />

    <h3 class="mb-3">ğŸ“Š Toplam Besin DeÄŸerleri</h3>

    <div class="row text-center">
        <div class="col-md-2">
            <strong>ğŸ”¥ Kalori</strong><br />
            @Math.Round(Model.NutritionFacts.Calories, 0) kcal
        </div>
        <div class="col-md-2">
            <strong>ğŸ¥© Protein</strong><br />
            @Math.Round(Model.NutritionFacts.Protein, 1) g
        </div>
        <div class="col-md-2">
            <strong>ğŸ§ˆ YaÄŸ</strong><br />
            @Math.Round(Model.NutritionFacts.Fat, 1) g
        </div>
        <div class="col-md-2">
            <strong>ğŸ Karbonhidrat</strong><br />
            @Math.Round(Model.NutritionFacts.Carbs, 1) g
        </div>
        <div class="col-md-2">
            <strong>ğŸ¬ Åeker</strong><br />
            @Math.Round(Model.NutritionFacts.Sugar, 1) g
        </div>
        <div class="col-md-2">
            <strong>ğŸŒ¾ Lif</strong><br />
            @Math.Round(Model.NutritionFacts.Fiber, 1) g
        </div>
    </div>
}
